\documentclass{report}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage[T2A]{fontenc}      
\usepackage[russian]{babel}
\usepackage{listings} 
\usepackage{titlesec}

\titleformat{\section}[block]{\filcenter\bfseries\large}{\thesection}{1em}{}
\titleformat{\subsection}[block]{\filcenter\bfseries\normalsize}{\thesubsection}{1em}{}

\begin{document}


\section*{Теоретический материал}
При движении тела в атмосфере Земли на него помимо силы тяжести также действует сила сопротивления воздуха
\begin{equation} \label{c13eq1}
	F(\nu) = i S \frac{\rho \nu^2}{2} C_x \left( \frac{\nu}{a} \right)
\end{equation}
где $i$ - коэффициент формы, $S$ - площадь лобового сечения, $\rho$ - плотность среды, $C_x$ - закон сопротивления, $a$ - скорость звука.

Для тела с круглым сечением, очевидно, 
\begin{equation} \label{c13eq2}
	S = \frac{\pi d^2}{4}.
\end{equation}

Плотность атмосферы $\rho$ является функцией виртуальной температуры $T_\nu$, давления $P_0$ в точке бросания, высоты полета $y$
\begin{equation} \label{c13eq3}
	\rho = \rho(y) = 1.225 \left( \frac{T(y)}{T_\nu} \right)^{4.256} \frac{P_0}{T_\nu} \frac{288.15}{760},
\end{equation}
где $T(y)$ - зависимость температуры от высоты
\begin{equation} \label{c13eq4}
	T(y) = T_\nu - 0.0065y.
\end{equation}

Скорость звука $a$ зависит от температуры в точке полета следующим образом:
\begin{equation} \label{c13eq5}
	a = 340.294 \left( \frac{T(y)}{288.15} \right)^{1/2}.
\end{equation}
Для учета влажности необходимо во всех формулах вместо реальной температуры $T_0$ использовать так называемую виртуальную температуру
\begin{equation} \label{c13eq6}
	T_\nu = \frac{T_0 + 273.15}{1 - \displaystyle \frac{3}{8} \frac{12.7}{P_0} w},
\end{equation}
где $w$ - влажность, выраженная в долях 1. В этой формуле $T_0$ - температура в градусах Цельсия в точке бросания, то есть в числителе дроби стоит абсолютная температура.

Для расчета закона сопротивления $C_x$ можно использовать следующий код:
\begin{lstlisting}[language=Python, basicstyle=\small]
def cx(x):
  pa = [0.0525, -0.9476, 8.9342, -9.4610, 0.3207, 4.2980, -1.9382]
  pb = [1.0000, -15.4071, 178.6690, -580.8643, 985.5873, -853.9492, 296.9213]
  pc = [0.0531, 0.9449, 90.5063, 0.1639]
  r = polyval(pa,x2) / polyval(pb,x2) + pc[0] / (1 + exp(-(x-pc[1])*pc[2])) + pc[3]
return r
\end{lstlisting}
Для учета деривации надо систему дифференциальных уравнений внешней баллистики для движения центра масс тела дополнить еще двумя уравнениями
\begin{equation} \label{c13eq7}
	\begin{split}
		\frac{dz}{dt} = q \nu_x \pi \nu_0 c_d, \\
		\frac{dq}{dt} = \frac{e^{-m_3 t}}{\nu^2}, 
	\end{split}
\end{equation}
где $\nu_x$ - горизонтальная компонента скорости, $\nu_0$ - начальная скорость, $\nu$ - модуль скорости, $c_d$ - коэффициент деривации, $m_3$ - коэффициент убывания угловой скорости вращения.

Если метание тела осуществляется с помощью порохового заряда, то начальная скорость тела будет зависеть от температуры заряда $T_z$
\begin{equation} \label{c13eq8}
	\nu_0 = \nu_{15} \left( 1 + z_t \left( T_z - 15 \right) \right),
\end{equation}
где $\nu_{15}$ - начальная скорость при $15^\circ C$, $z_t$ - коэффициент температуры заряда.

Для учета влияния ветра необходимо сперва перейти в систему отсчета, связанную с ветром, где атмосфера неподвижна, затем решить задачу и при необходимости вернуться в исходную систему отсчета.

Заметим, что в баллистике принято углы выражать в так называемых делениях угломера (д.у.). По определению, окружность делится на 6000 таких делений, т.е.
\begin{equation} \label{c13eq9}
	1 \textit{д.у.} = \frac{\pi}{3000} = 0.06^\circ.
\end{equation}
\section*{Задание}
\begin{enumerate}
\item Определить угол бросания для пули Б-32 пулемета НСВ-12.7 на дальность 2000м с точностью не хуже 0.01 д.у., если
\begin{equation} \nonumber
	\begin{split}
		g = 9.80665 \textit{м}/\textit{с}^2, \\
		d = 12.7 \textit{мм}, \\
		m = 48.3 \textit{г}, \\
		i = 1.0629, \\
		\nu_{15} = 820 \textit{м}/\textit{с}, \\
		P_0 = 750 \textit{мм.рт.с.}, \\
		T_0 = 15^\circ C, \\
		w = 0.5, \\
		z_t = 1.35 \cdot 10^{-3}, \\
		c_d = 0.0423, \\
		m_3 = 0.1744.
	\end{split}
\end{equation}
Здесь $m$ - масса пули. Повторить расчет для  $T = 5^\circ C$.

\textbf{\textit{Указание:}} перейти от независимой переменной $t$ к переменной $x$ (координата пули вдоль траектории).

\item Определить угол бросания и горизонтальную угловую поправку с учетом ветра и деривации в условиях предыдущей задачи ($T_0 = 15^\circ C$), если скорость ветра 10м/c, он дует справа налево перпендикулярно траектории, а деривация приводит к смещению пули вправо.

\item Определить максимальную дальность полета в условиях 1 задания ($T_0 = 15^\circ C$).
\end{enumerate}

\end{document}
