\chapter{}

\section{Теоретический материал к семинару №3}

Семейство одностадийных схем Розенброка для задачи Коши
\begin{equation} \label{c3eq1}
	\begin{cases}
		\displaystyle \frac{d\mathbf{u}}{dt} = \mathbf{f} \left( \mathbf{u}, t \right) \\
		\mathbf{u}(t_0) = \mathbf{u}_0
	\end{cases}
\end{equation}
имеет следующий вид:
\begin{equation} \label{c3eq2}
	\begin{cases}
		\displaystyle \left( \mathbf{E} - \alpha \tau \mathbf{f_u} \right) \boldsymbol{\omega}= \mathbf{f} \left( \mathbf{u}, t + \frac{\tau}{2} \right) \\
		\mathbf{\hat{u}} = \mathbf{u} + \tau \operatorname{Re} \boldsymbol{\omega}
	\end{cases}
\end{equation}
Здесь $\alpha$ - параметр схемы, $\tau$ - шаг схемы по времени, $\mathbf{f_u}$ - матрица производных правой части по вектору $\mathbf{u}$, $\mathbf{u}$ и $\mathbf{\hat{u}}$ - численное решение в текущий и следующий моменты времени соответственно. Практический интерес представляют схемы из семейства одностадийных схем Розенброка при  
\begin{equation} \nonumber
\alpha = \frac{1}{2},
\qquad
\alpha = 1,
\qquad
\alpha = \frac{1+i}{2}.
\end{equation}

Векторная переменная $\boldsymbol{\omega}$ получается из решения системы линейных уравнений с правой частью $\mathbf{f} \left( \mathbf{u}, t + \tau/2 \right)$ и матрицей системы $\mathbf{E} - \alpha \tau \mathbf{f_u}$. Эту матрицу \textbf{\textit{не следует}} обращать численно, так как если вычислять  $\boldsymbol{\omega}$ как 
\begin{equation} \nonumber
	\left( \mathbf{E} - \alpha \tau \mathbf{f_u} \right)^{-1} \mathbf{f} \left( \mathbf{u}, t + \frac{\tau}{2} \right),
\end{equation}
то это потребует большего объема вычислений, чем решение линейной системы. Особенно заметна разница в производительности, если матрица системы имеет ленточную форму, что часто бывает при применении схем Розенброка к решению систем дифференциальных уравнений, возникающий при численном решении уравнений в частных производных.

Матрицу производных $\mathbf{f_u}$ при реализации схем Розенброка в общем виде лучше вычислять численно с помощью центральной разности с шагом $\Delta u = 10^{-5}$. Ее надо строить таким образом, чтобы в 1 строке $\mathbf{f_u}$ были производные 1 компоненты вектор-столбца $\mathbf{f}$, по всем компонентам $\mathbf{u}$, во 2 строке - производные 2 компоненты $\mathbf{f}$ по всем компонентам $\mathbf{u}$ и т.д.

\newpage

\section*{Задачи к семинару №3}
\begin{enumerate}
\item Решить задачу Коши с правой частью, задаваемой функцией  

Python:
\begin{minted}[linenos=false,frame=lines,framesep=2mm,baselinestretch=1.2,fontsize=\footnotesize]{python}
import numpy as np

def f(t, u):
    y = np.array([-50*(u[0]-np.cos(t))+10*u[1], 
                  1.2*u[0]-u[1]*u[0]])
    return y
\end{minted}
MATLAB:
\begin{matlablisting}
	\begin{verbatim}
function y = f(t, u)
     y = [-50*(u(1)-cos(t))+10*u(2); 
           1.2*u(1)-u(2)*u(1)       ];
end		
	\end{verbatim}
\end{matlablisting}
на временном отрезке $[0; 0.75]$
при начальном значении $u0 = [1; 1]$ с помощью явной схемы Рунге-Кутта второго порядка типа предиктор-корректор, задаваемой матрицей Бутчера $\mathbf{A}$ и векторами $\mathbf{a}$ и $\mathbf{b}$ (см. предыдущий семинар)
\begin{equation} \nonumber
	\mathbf{A} = 
		\begin{pmatrix}
		0 & 0 \\
		1/2 & 0 \\
		\end{pmatrix},
	\qquad
	\mathbf{a} = 
		\begin{pmatrix}
		0 \\
		1/2 \\
		\end{pmatrix},
	\qquad
	\mathbf{b} = 
		\begin{pmatrix}
		0 \\
		1 \\
		\end{pmatrix}^T.
\end{equation}
Расчет провести с шагом по времени $\tau = 1/8$ и $\tau = 1/128$.
\item Реализовать семейство одностадийных схем Розенброка в общем виде. Для тестирования использовать задачу Коши из предыдущей задачи. Положить на один график результаты расчета этой задачи при $\alpha = \frac{1}{2}, \alpha = 1, \alpha = \frac{1+i}{2}$. Взять шаг по времени $\tau = 1/8$. На тот же график положить результат расчета, полученный явной схемой, при $\tau = 1/128$. На графике должны присутствовать обе компоненты вектора решения (т.е. всего должно быть 8 кривых). Для построения графика удобно использовать, например, такие команды:
\newpage
Python:
\begin{minted}[linenos=false,frame=lines,framesep=2mm,baselinestretch=1.2,fontsize=\footnotesize]{python}
import matplotlib.pyplot as plt

plt.plot(t, cros, 'r+-', label='cros')
plt.plot(t, ros05, 'g+-', label='ros05')
plt.plot(t, ros1, 'b+-', label='ros1')
plt.plot(t0, rk2, 'k', label='rk2')
plt.legend()
plt.show()
\end{minted}
MATLAB:
\begin{matlablisting}
	\begin{verbatim}
plot(t,cros,'r+-',t,ros05,'g+-',t,ros1,'b+-',t0,rk2,'k');
	\end{verbatim}
\end{matlablisting}
Здесь $t$ задает редкую сетку по времени, а $t_0$ – более подробную. 

Объяснить поведение кривых численного решения в терминах $A$-устойчивость, $Lp$-устойчивость, $t$–монотонность.

\end{enumerate}
